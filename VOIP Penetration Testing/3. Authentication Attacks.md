### Authentication Attacks

SIP can be susceptible to 2 types of authentication attacks, before we take a look at these attacks types let’s understand how’s a SIP registration and authentication process takes place. SIP uses a digest authentication which is a mechanism that the HTTP protocol uses and known as HTTP digest. Because SIP is an ASCII based protocol the authentication details are hashed in order to prevent them to transport in clear text.
When a SIP client (User Agent) wants to authenticate with a SIP server, the server generates and sends a digest challenge to the client, it contains the following parameters: 

![image](https://user-images.githubusercontent.com/48615614/204590197-78e07918-12a4-43e6-82a0-cd67fa2d60c1.png)

`Realm` - used to identify credentials within as SIP message, usually it is the sip domain. Nonce - this is an md5 unique string which is generated by the server for each registration request it is made from a time stamp and a secret phrase to ensure it has a limited lifetime and could be not be used again. Once the client receives the digest challenge and the user enters his credentials the client uses the nonce to generate a digest response and sends it back to the server. 

![image](https://user-images.githubusercontent.com/48615614/204590434-0453d862-cdc8-41c7-8d4f-6395d2c73f0d.png)

#### Cracking SIP Digest response hashes

Crack using SIPCrack tool:

![image](https://user-images.githubusercontent.com/48615614/204590609-39e78653-3d0a-4e4c-94b3-b42a4bb76d70.png)

SIPCrack can operate in two modes:

	• Dictionary attack
	• STDIN

Now we can generate a wordlist for brute forcing using crunch tool.

Dictionary attack

Creating a six chars numeric dictionary:

![image](https://user-images.githubusercontent.com/48615614/204591051-44b9383c-3de8-4266-88b4-8e091f4e95e5.png)

We will use a previously captured sip credentials stored by SIPDump in the auth.txt file ans sipass.txt as the dictionary (which we created using crunch)

#### Cracking the Digest Response

![image](https://user-images.githubusercontent.com/48615614/204591415-f7827702-ba4d-42bb-8c2f-1e6572e2f0f7.png)

#### Brute Force attack using John The Ripper

For this attack mode we will be using John the ripper to redirect johns output into the FIFO file which we’ll feed into SIPCrack. Creating a FIFO file: 

![image](https://user-images.githubusercontent.com/48615614/204591669-d41f54b9-4aad-44a7-a43d-0c065be37656.png)

Generating passwords using john and redirecting the output to our FIFO file, for this example we will generate up to 6 digits only. 

![image](https://user-images.githubusercontent.com/48615614/204591861-76fe5589-764e-4d4b-bbeb-dc4b9404daaa.png)

Using our FIFO file to crack the password: 

![image](https://user-images.githubusercontent.com/48615614/204591932-bce3b8cd-d058-4923-8347-598a44ec3f59.png)

#### Brute forcing SIP Accounts
We can use svcrack which is a part of the sipvicious tools suite to brute force sip accounts A single SIP account dictionary attack (You can add a -v or -vv for verbosity):

![image](https://user-images.githubusercontent.com/48615614/204597253-acd36b01-cc90-4dc1-8bab-131e6849190c.png)

A single SIP account brute forcing: 

![image](https://user-images.githubusercontent.com/48615614/204597435-35c7be3f-fb34-4189-beaa-e668d89a72e0.png)

A single SIP account brute forcing: 

![image](https://user-images.githubusercontent.com/48615614/204598114-04bc0a62-aeb5-4b4d-a18d-7c1364f3ffe0.png)




