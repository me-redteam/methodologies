### How does Unintended Data Leakage work?
First, a developer’s code processes sensitive information supplied by the user or the backend. During that processing, a side-effect (that is unknown to the developer) results in that information being placed into an insecure location on the mobile device that other apps on the device may have open access to. Typically, these side-effects originate from the underlying mobile device’s operating system (OS). An attacker can simply write a small piece of code to access the location where the sensitive information is stored.

Below you can find examples of unintended data leakage in Android OS:
 
• URL Caching (Both request and response)
  
• Keyboard Press Caching
  
• Copy/Paste buffer Caching

• Application backgrounding

• Logging

• Analytics data sent to 3rd parties
  
  <br><br>
  
#### 3.1 Information Disclosure through Logcat/Apple System Log (ASL) Logging

Android `Logs` is a great place to look for information leakage. Logging techniques are generally used by developers for debugging purposes during their application development.
In the below scenario I will explain how sensitive information could be leaked via Android logs using `adb` tool.
First step using `adb` tool we can start using `adb logcat` so we can check how the application log the data, so simply we can use the following command to save the output in a text file `adb logcat > logs.txt` as shown below:

![image](https://user-images.githubusercontent.com/48615614/203750274-7f531c64-bef3-4567-9731-59c1479a9f02.png)

As you can see below I will try to login to the online banking application `InsecureBankv2` with username `dinesh` and password `Dinesh@123$`.

![image](https://user-images.githubusercontent.com/48615614/203750387-28cfe67d-0712-4d8e-90f4-b0d5597b91dd.png)

Now we can start investigate on the logs files `logs.txt` to check if the application logging a sensitive information such as the username and password or not:
By using grep on the text file as shown below:
![image](https://user-images.githubusercontent.com/48615614/203750506-86867dc7-cc6c-4d42-b7ce-85bb2bb04614.png)

By using `cat logs.txt | grep "dinesh"` command I was able to find the username and password in a clear text which is Unintended Data Leakage vulnerability.


<br>

#### 3.2 Exposing Device Specific Identifiers in Attacker Visible Elements

where apps use third party APIs. Using this app, the third party APIs may read sensitive information such as device ID and location from the device.

3rd party services are mostly implemented in two ways:
	• By using a standalone library, like a Jar in an Android project that is getting included into the APK.
	• By using a full SDK.

#### Static Analysis
Some 3rd party libraries can be automatically integrated into the app through a wizard within the IDE. The permissions set in the AndroidManifest.xml when installing a library through an IDE wizard should be reviewed. Especially permissions to access SMS `READ_SMS`, contacts `READ_CONTACTS` or the location `ACCESS_FINE_LOCATION` should be challenged if they are really needed to make the library work at a bare minimum, see also Testing App Permissions. When talking to developers it should be shared to them that it’s actually necessary to have a look at the differences on the project source code before and after the library was installed through the IDE and what changes have been made to the code base.

The same thing applies when adding a library or SDK manually. The source code should be checked for API calls or functions provided by the 3rd party library or SDK. The applied code changes should be reviewed and it should be checked if available security best practices of the library and SDK are applied and used.
The libraries loaded into the project should be reviewed in order to identify with the developers if they are needed and also if they are out of date and contain known vulnerabilities.


#### Dynamic Analysis
All requests made to external services should be analyzed if any sensitive information is embedded into them. Dynamic analysis can be performed by launching a Man-in-the-middle (MITM) attack using Burp Suite Professional or OWASP ZAP, to intercept the traffic exchanged between client and server. Once we are able to route the traffic to the interception proxy, we can try to sniff the traffic from the app to the server and vice versa. When using the app all requests that are not going directly to the server where the main function is hosted should be checked, if any sensitive information is sent to a 3rd party. This could be for example PII (Personal Identifiable Information) in a tracker or ad service.

#### Remediation
All data that is sent to 3rd Party services should be anonymized, so no PII data is available. Also all other data, like IDs in an application that can be mapped to a user account or session should not be sent to a third party.
AndroidManifest.xml should only contain the permissions that are absolutely needed to work properly and as intended.


